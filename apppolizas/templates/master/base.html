{% load static %}
<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>{% block title %}Admin Dashboard{% endblock %}</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet" />

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />

  <link rel="stylesheet" href="{% static 'css/masteradmin.css' %}" />
  <link rel="stylesheet" href="{% static 'css/sidebar_admin_compact.css' %}" />
  <link rel="stylesheet" href="{% static 'css/gSide.css' %}" />

  {% block extra_css %}{% endblock %}
</head>

<body>

  <aside class="menu">
    <div class="row1">
      <img src="{% static 'images/utpl.png' %}" alt="Logo Cámara de Comercio" class="logo">
    </div>

    <div class="row1">
      <div class="imagen-redonda">
        <img src="{% static 'images/perfil.jpg' %}" alt="Usuario" class="foto-perfil">
      </div>
      <p class="nombre-usuario">
        {% if user.get_full_name %}
          {{ user.get_full_name }}
        {% else %}
          {{ user.username|title }}
        {% endif %}
        <span class="rol-usuario">({{ user.rol|title }})</span>
      </p>
    </div>

    <nav class="navbar-menu">
      <ul>
        <li class="{% if request.resolver_match.url_name == 'dashboard_admin' or request.resolver_match.url_name == 'dashboard_analista' %}activo{% endif %}" style="width: 110%">
          <a href="{% if user.rol == 'admin' %}{% url 'dashboard_admin' %}{% else %}{% url 'dashboard_analista' %}{% endif %}">
            <img src="{% static 'images/icono1.svg' %}" alt="Icono" class="icono-svg">
            Dashboard
          </a>
        </li>

        {% if user.rol == 'admin' %}
        <li class="{% if request.resolver_match.url_name == 'admin_usuarios' %}activo{% endif %}" style="width: 110%">
          <a href="{% url 'admin_usuarios' %}">
            <img src="{% static 'images/icono2.svg' %}" alt="Icono" class="icono-svg">
            Usuarios
          </a>
        </li>
        {% endif %}

        <li class="{% if request.resolver_match.url_name == 'polizas_list' %}activo{% endif %}">
          <a href="{% url 'polizas_list' %}">
            <img src="{% static 'images/icono2.svg' %}" class="icono-svg">
            Pólizas
          </a>
        </li>

        <li class="{% if request.resolver_match.url_name == 'siniestros' %}activo{% endif %}">
          <a href="{% url 'siniestros' %}">
            <img src="{% static 'images/icono3.svg' %}" class="icono-svg">
            Siniestros
          </a>
        </li>

        <li class="{% if 'factura' in request.resolver_match.url_name %}activo{% endif %}">
          <a href="{% url 'lista_facturas' %}">
            <img src="{% static 'images/icono4.png' %}" class="icono-svg">
              Facturación
          </a>
        </li>

        <li class="{% if 'custodio' in request.resolver_match.url_name %}activo{% endif %}">
          <a href="{% url 'custodios_list' %}">
            <i class="fas fa-users icono-svg" style="font-size: 1.2rem; margin-right: 10px;"></i>
              Custodios
          </a>
        </li>

        <li class="{% if 'notificaciones' in request.resolver_match.url_name %}activo{% endif %}">
          <a href="{% url 'lista_notificaciones' %}">
            <i class="fas fa-bell" style="font-size: 20px; margin-right: 10px; width: 24px; text-align: center;"></i>
              Notificaciones
          </a>
        </li>

        <li class="{% if request.resolver_match.url_name == 'reportes_externos_list' %}activo{% endif %}">
          <a href="{% url 'reportes_externos_list' %}">
            <i class="fas fa-exclamation-triangle" style="font-size: 20px; margin-right: 10px; width: 24px; text-align: center;"></i>
              Reportes Externos
            {% if reportes_externos_pendientes > 0 %}
              <span class="badge bg-danger ms-2">{{ reportes_externos_pendientes }}</span>
            {% endif %}
          </a>
        </li>

      </ul>
    </nav>
    
    <!-- Espacio flexible para empujar el botón hacia abajo -->
    <div class="flex-grow-1"></div>
    
    <!-- Botón de Cerrar Sesión al final -->
    <button type="button" id="btnLogout" class="boton">
      Cerrar Sesión
    </button>
  </aside>

  <main class="main-content-admin">
    <div class="top-bar-admin">
      <h2 id="section-title-admin">
        {% if request.resolver_match.url_name == 'admin_usuarios' %}
        Usuarios Registrados
        {% elif request.resolver_match.url_name == 'polizas_list' %}
        Pólizas
        {% elif request.resolver_match.url_name == 'siniestros' %}
        Siniestros
        {% elif request.resolver_match.url_name == 'reportes_externos_list' %}
        Reportes Externos
        {% elif request.resolver_match.url_name == 'dashboard_admin' or request.resolver_match.url_name == 'dashboard_analista' %}
        Dashboard
        {% else %}
        Contenido
        {% endif %}
      </h2>
      <div class="topbar-right-group d-flex align-items-center gap-3">
        <div class="notification-icon">
          <i class="far fa-bell"></i>
        </div>
        <div class="search-box-admin">
          <input type="text" placeholder="Buscar" />
          <div class="search-icon-right">
            <i class="fas fa-search"></i>
          </div>
        </div>
      </div>
    </div>

    <div class="admin-scroll-content">
      {% block content %}{% endblock %}
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script src="{% static 'js/masteradmin.js' %}" defer></script>
  {% block extra_js %}{% endblock %}
</body>

</html>
